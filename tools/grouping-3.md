---
title: "N人を3人のグループにまとめる"
---


## このページについて

N人を3人ずつのグループにまとめます（人数によっては2人だけのグループが現れます）。演習でのグループ分けに用いることを念頭に置いています。

N が 10 以下の結果を示します。

## 4人

```
01：["01", "02"], ["03", "04"]
02：["01", "03"], ["02", "04"]
03：["01", "04"], ["02", "03"]
```

## 5人

```
01：["01", "02", "03"], ["04", "05"]
02：["01", "02", "04"], ["03", "05"]
03：["01", "02", "05"], ["03", "04"]
04：["01", "02"], ["03", "04", "05"]
05：["01", "03", "04"], ["02", "05"]
06：["01", "03", "05"], ["02", "04"]
07：["01", "03"], ["02", "04", "05"]
08：["01", "04", "05"], ["02", "03"]
09：["01", "04"], ["02", "03", "05"]
10：["01", "05"], ["02", "03", "04"]
```

## 6人

```
01：["01", "02", "03"], ["04", "05", "06"]
02：["01", "02", "04"], ["03", "05", "06"]
03：["01", "02", "05"], ["03", "04", "06"]
04：["01", "02", "06"], ["03", "04", "05"]
05：["01", "03", "04"], ["02", "05", "06"]
06：["01", "03", "05"], ["02", "04", "06"]
07：["01", "03", "06"], ["02", "04", "05"]
08：["01", "04", "05"], ["02", "03", "06"]
09：["01", "04", "06"], ["02", "03", "05"]
10：["01", "05", "06"], ["02", "03", "04"]
```


## 7人

```
01：["01", "02", "03"], ["04", "05"], ["06", "07"]
02：["01", "02", "04"], ["03", "06"], ["05", "07"]
03：["01", "02", "05"], ["03", "07"], ["04", "06"]
04：["01", "02", "06"], ["03", "05"], ["04", "07"]
05：["01", "02", "07"], ["03", "04"], ["05", "06"]
06：["01", "03"], ["02", "04"], ["05", "06", "07"]
07：["01", "04"], ["02", "05"], ["03", "06", "07"]
08：["01", "05"], ["02", "03"], ["04", "06", "07"]
09：["01", "06"], ["02", "07"], ["03", "04", "05"]
```

## 8人

```
01：["01", "02", "03"], ["04", "05", "06"], ["07", "08"]
02：["01", "02", "04"], ["03", "05", "07"], ["06", "08"]
03：["01", "02", "05"], ["03", "04", "08"], ["06", "07"]
04：["01", "02", "06"], ["03", "04", "07"], ["05", "08"]
05：["01", "02", "07"], ["03", "04"], ["05", "06", "08"]
06：["01", "02", "08"], ["03", "04", "06"], ["05", "07"]
07：["01", "02"], ["03", "04", "05"], ["06", "07", "08"]
08：["01", "03", "04"], ["02", "06"], ["05", "07", "08"]
09：["01", "03", "05"], ["02", "06", "07"], ["04", "08"]
10：["01", "03", "06"], ["02", "05", "08"], ["04", "07"]
11：["01", "03", "07"], ["02", "04", "08"], ["05", "06"]
12：["01", "03", "08"], ["02", "04"], ["05", "06", "07"]
13：["01", "03"], ["02", "05", "06"], ["04", "07", "08"]
14：["01", "04", "05"], ["02", "06", "08"], ["03", "07"]
15：["01", "04", "06"], ["02", "05", "07"], ["03", "08"]
16：["01", "04", "07"], ["02", "05"], ["03", "06", "08"]
17：["01", "04", "08"], ["02", "07"], ["03", "05", "06"]
18：["01", "05", "07"], ["02", "03", "08"], ["04", "06"]
19：["01", "05", "08"], ["02", "03"], ["04", "06", "07"]
20：["01", "05"], ["02", "03", "07"], ["04", "06", "08"]
21：["01", "06", "08"], ["02", "04", "07"], ["03", "05"]
22：["01", "06"], ["02", "04", "05"], ["03", "07", "08"]
23：["01", "07", "08"], ["02", "03", "06"], ["04", "05"]
24：["01", "07"], ["02", "04", "06"], ["03", "05", "08"]
```

## 9人

```
01：["01", "02", "03"], ["04", "05", "06"], ["07", "08", "09"]
02：["01", "02", "04"], ["03", "05", "07"], ["06", "08", "09"]
03：["01", "02", "05"], ["03", "04", "08"], ["06", "07", "09"]
04：["01", "02", "06"], ["03", "04", "07"], ["05", "08", "09"]
05：["01", "02", "07"], ["03", "04", "09"], ["05", "06", "08"]
06：["01", "02", "08"], ["03", "04", "06"], ["05", "07", "09"]
07：["01", "02", "09"], ["03", "04", "05"], ["06", "07", "08"]
08：["01", "03", "04"], ["02", "06", "09"], ["05", "07", "08"]
09：["01", "03", "05"], ["02", "06", "07"], ["04", "08", "09"]
10：["01", "03", "06"], ["02", "05", "08"], ["04", "07", "09"]
11：["01", "03", "07"], ["02", "04", "08"], ["05", "06", "09"]
12：["01", "03", "08"], ["02", "04", "09"], ["05", "06", "07"]
13：["01", "03", "09"], ["02", "05", "06"], ["04", "07", "08"]
14：["01", "04", "05"], ["02", "06", "08"], ["03", "07", "09"]
15：["01", "04", "06"], ["02", "05", "07"], ["03", "08", "09"]
16：["01", "04", "07"], ["02", "05", "09"], ["03", "06", "08"]
17：["01", "04", "08"], ["02", "07", "09"], ["03", "05", "06"]
18：["01", "05", "07"], ["02", "03", "08"], ["04", "06", "09"]
19：["01", "05", "08"], ["02", "03", "09"], ["04", "06", "07"]
20：["01", "05", "09"], ["02", "03", "07"], ["04", "06", "08"]
21：["01", "06", "08"], ["02", "04", "07"], ["03", "05", "09"]
22：["01", "06", "09"], ["02", "04", "05"], ["03", "07", "08"]
23：["01", "07", "08"], ["02", "03", "06"], ["04", "05", "09"]
24：["01", "07", "09"], ["02", "04", "06"], ["03", "05", "08"]
```

## 10人

```
01：["01", "02", "03"], ["04", "05", "06"], ["07", "08"], ["09", "10"]
02：["01", "02", "04"], ["03", "05", "06"], ["07", "09"], ["08", "10"]
03：["01", "02", "05"], ["03", "04", "06"], ["07", "10"], ["08", "09"]
04：["01", "02", "06"], ["03", "04"], ["05", "07"], ["08", "09", "10"]
05：["01", "02", "07"], ["03", "04", "08"], ["05", "09"], ["06", "10"]
06：["01", "02", "08"], ["03", "04", "07"], ["05", "10"], ["06", "09"]
07：["01", "02", "09"], ["03", "04", "10"], ["05", "08"], ["06", "07"]
08：["01", "02", "10"], ["03", "05", "07"], ["04", "09"], ["06", "08"]
09：["01", "02"], ["03", "04", "09"], ["05", "06"], ["07", "08", "10"]
10：["01", "03", "05"], ["02", "06"], ["04", "08"], ["07", "09", "10"]
11：["01", "03", "06"], ["02", "05"], ["04", "10"], ["07", "08", "09"]
12：["01", "03", "07"], ["02", "08"], ["04", "05"], ["06", "09", "10"]
13：["01", "03", "08"], ["02", "07"], ["04", "06"], ["05", "09", "10"]
14：["01", "03", "09"], ["02", "10"], ["04", "07"], ["05", "06", "08"]
15：["01", "03"], ["02", "04"], ["05", "07", "09"], ["06", "08", "10"]
16：["01", "04", "05"], ["02", "09"], ["03", "08"], ["06", "07", "10"]
17：["01", "04"], ["02", "03"], ["05", "07", "10"], ["06", "08", "09"]
18：["01", "05"], ["02", "04", "08"], ["03", "10"], ["06", "07", "09"]
19：["01", "06"], ["02", "04", "07"], ["03", "09"], ["05", "08", "10"]
20：["01", "07"], ["02", "04", "10"], ["03", "06"], ["05", "08", "09"]
21：["01", "08"], ["02", "04", "09"], ["03", "07"], ["05", "06", "10"]
22：["01", "09"], ["02", "06", "07"], ["03", "05"], ["04", "08", "10"]
```


## ソースコード

- [Using the compiler - Crystal](https://crystal-lang.org/reference/using_the_compiler/index.html) の `Release Build` を使うことをおすすめします。
- [Compile & run code in Crystal](https://play.crystal-lang.org/#/cr) を使用すると、あまり速度が出ません。

```crystal
class Array
  @number_of_elements_in_one_group = 0

  def set_number_of_elements_in_one_group(number)
    @number_of_elements_in_one_group = number
  end

  def number_of_groups
    (self.size / @number_of_elements_in_one_group).to_i
  end

  def my_fill_with_string
    number = @number_of_elements_in_one_group
    if self.size.modulo(number) > 0
      (number - self.size.modulo(number)).times { |i|
        self.push("dummy#{i + 1}")
      }
    end
  end

  # ダミー文字列を除去
  def remove_filler
    result = self.map { |group|
      group = group.join(" ").gsub(/dummy\d/, "").split(" ")
      group.select { |elem| elem != "" }
    }
    self.replace(result)
  end

  # グループに1人しかいないパターンを除外
  def remove_group_with_only_one_element
    self.replace(self.select { |item| item.size > 1 })
  end

  def my_include?(elem : String)
    self.include?(elem)
  end
end

ARGV.each do |max_number|
  # max_number = 7

  # 1グループあたりの人数
  number_of_elements_in_one_group = 3

  source = (1..max_number.to_i).to_a.map { |item| sprintf("%02d", item) }

  # グループ分けしやすいようダミー文字列で埋めておく
  source.set_number_of_elements_in_one_group(number_of_elements_in_one_group)
  source.my_fill_with_string

  # 人の組み合わせを求める
  people_pattern = source.combinations(number_of_elements_in_one_group)

  people_pattern.remove_filler
  people_pattern.uniq!
  people_pattern.remove_group_with_only_one_element

  # 1回目、2回目……n回目のグループの組み合わせを求める
  group_pattern = people_pattern.combinations(source.number_of_groups)

  # 1人が同時に複数のグループに属する場合を除外し、そして
  # 全員が現れない場合も除外
  group_pattern.select! { |item|
    item2 = item.flatten
    (item2.size - item2.uniq.size) == 0 && max_number.to_i == item2.size
  }


  # 一度出現したグループが見つかったらスキップ
  uniq_group = Array(Array(String)).new

  group_pattern.select! { |groups|
    result = groups.each.all? { |group|
      !uniq_group.find { |uniq_pattern| group == uniq_pattern }
    }

    if result
      groups.each { |group|
        uniq_group.push(group)
      }
    end

    result
  }

  group_pattern.each.with_index(1) do |element, index|
    puts "#{sprintf("%02d", index)}：#{element.join(", ")}"
  end
end
```
